<i class="fa fa-step-backward" *ngIf="sourcekey" (click)="nav.back()"></i>
<form [formGroup]="erppurchaseorderdetailForm" (ngSubmit)="onSubmit()" [ngClass]="theme">
  <div class="row second">
    <h1 class="col-4 columns mainheader left"><a href='#/home/{{pcurrenturl}}'>{{'Purchase Order Details' |
        translate}}</a></h1>
    <div class='col  sticky1 second' role='toolbar' aria-label='Toolbar with button groups'>
      <!--btn-toolbar-->
      <div class='col'></div>
      <div class='dropdown d-inline-block btn-dropdown show'>

        <ul class='nav nav-pills  input-group'>
          <li><a class='nav-link active' [routerLink]='' *ngIf='showview' (click)="editerppurchaseorderdetails()"><i
                class="nb-edit"></i>Edit</a></li>
          <li class='nav-item actionheader col'>
            <a [routerLink]='' (click)='first()'><i class='fa fa-fast-backward'
                aria-hidden='true'></i></a>&nbsp;&nbsp;&nbsp;&nbsp;<a [routerLink]='' (click)='prev()'><i
                class='fa fa-step-backward' aria-hidden='true'></i></a>&nbsp;&nbsp;
            <app-popupselect [options]='pkList' [optionsEvent]='pkoptionsEvent' [form]='pkform'
              (selectItem)='onSelectedpk($event)' [reportid]=31 [menuid]=31 formControlName='pk' id='pk' desc=''>
            </app-popupselect>

            <a [routerLink]='' (click)='next()'><i class='fa fa-step-forward' aria-hidden='true'></i></a>&nbsp;&nbsp; <a
              [routerLink]='' (click)='last()'><i class='fa fa-fast-forward' aria-hidden='true'></i></a>

          </li>
          <li *ngIf='!showview' class='nav-item dropdown  actionheader'>
            <a class='nav-link dropdown-toggle btn-success' (click)='erppurchaseorderdetailtoggleOption()'
              data-toggle='dropdown' [routerLink]='' role='button' aria-haspopup='true'
              aria-expanded='false'>Actions</a>

            <div class='dropdown-menu' style='display:block' *ngIf='this.erppurchaseorderdetailshowOption'>
              <div class='dropdown-divider'></div>

              <a class='dropdown-item' *ngIf='ScreenType!=2' [routerLink]='' (click)='resetForm()'><i class='fa fa-plus'
                  aria-hidden='true'></i>&nbsp;&nbsp;&nbsp;New</a>
              <a class='dropdown-item' [routerLink]='' (click)='onSubmit()'><i class='fa fa-save'
                  aria-hidden='true'></i>&nbsp;&nbsp;&nbsp;Save</a>
              <a class='dropdown-item' [routerLink]='' (click)='onDelete()'><i class='fa fa-trash'
                  aria-hidden='true'></i>&nbsp;&nbsp;&nbsp;Delete</a>

              <div class='dropdown-divider'></div>

              <a class='dropdown-item' [routerLink]='' (click)='onCopy()'><i class='fa fa-copy'
                  aria-hidden='true'></i>&nbsp;&nbsp;&nbsp;Copy</a>
              <a class='dropdown-item' [routerLink]=''><i class='fa fa-clipboard'
                  aria-hidden='true'></i>&nbsp;&nbsp;&nbsp;Clipboard</a>
              <a class='dropdown-item' [routerLink]=''><i class='fa fa-print'
                  aria-hidden='true'></i>&nbsp;&nbsp;&nbsp;Print</a>
              <a class='dropdown-item' [routerLink]=''><i class='fa fa-envelope'
                  aria-hidden='true'></i>&nbsp;&nbsp;&nbsp;Mail</a>


            </div>
          </li>
          <li class='nav-item actionheader' *ngIf="!showview">
            <a class="nav-link active" [routerLink]='' (click)="onSubmitAndWait()"><i class="fa fa-database"></i>
              Submit</a>
            <a class="nav-link active" [routerLink]='' (click)="onSubmit()"><i class="fa fa-share-square"></i> Submit &
              Clear</a>
            <app-action *ngIf="f.podetailid.value != null" (afteraction)="afteraction($event)" [menuid]="pmenuid"
              [value]="f.podetailid.value" [status]="f.status.value"></app-action>
            <a class="nav-link" [routerLink]='' (click)="onClose()"
              *ngIf="maindata!=undefined && maindata!=null && (maindata.ScreenType==1 || maindata.ScreenType==2)"
              class=""><i class="fa fa-close"></i> Close</a>
          </li>

        </ul>
      </div>
    </div>
  </div>
  <div class="container"   id="contentArea1"  >
    <div class="w-5" *ngIf="showformtype=='1'" style="margin-top:10px!important">
      <div (click)="PrevForm()"><i title="Form" class="fa fa-file"></i></div>
    </div>
    <div *ngIf="(viewhtml != '' && showview)" innerHTML='{{getHtml(viewhtml)}}'>

    </div>
    <ngb-tabset class="tabset1" [destroyOnHide]="false">
      <div *ngIf="(viewhtml != '' && showview)" innerHTML='{{getHtml(viewhtml)}}'>

      </div>
      <ngb-tab>
        <ng-template ngbTabTitle>
          <div (click)="ToolBar(true)">Master</div>
        </ng-template>
        <ng-template ngbTabContent>
          <p-accordion [multiple]='true'>


            <!--poid-->

            <div *ngIf="(viewhtml == '' || !showview)" class="form-group row">
              <div *ngIf="hidelist.indexOf('poid') == -1" class="col"><label for="poid" class="control-label"
                  (click)="AddOrEditpoid(null)">P O</label>
                <app-popupselect *ngIf="!showview" [options]="poidList" [optionsEvent]="poidoptionsEvent"
                  [form]="erppurchaseordermaster" (selectItem)="onSelectedpoid($event)" [reportid]='wxtyf'
                  [menuid]='wxtyf' formControlName="poid" id="poid" desc="ponumber"></app-popupselect>
                <div class="input-group">
                </div>
                <label *ngIf="showview" class="labelview">{{f.poid?.value}}</label>
              </div>


              <!--supplierid-->

              <div *ngIf="hidelist.indexOf('supplierid') == -1" class="col"><label for="supplierid"
                  class="control-label" (click)="AddOrEditsupplierid(null)">Supplier</label>
                <app-popupselect *ngIf="!showview" [options]="supplieridList" [optionsEvent]="supplieridoptionsEvent"
                  [form]="erpsuppliermaster" (selectItem)="onSelectedsupplierid($event)" [reportid]='qtmcq'
                  [menuid]='qtmcq' formControlName="supplierid" id="supplierid" desc="suppliercode"></app-popupselect>
                <div class="input-group">
                </div>
                <label *ngIf="showview" class="labelview">{{f.supplierid?.value}}</label>
              </div>
              <div *ngIf="hidelist.indexOf('versionnumber') == -1" class="col ">
                <label for="versionnumber" class="control-label">Version Number</label>
                <label *ngIf="showview" class="labelview">{{f.versionnumber?.value}}</label>
                <input *ngIf="!showview" id="versionnumber" formControlName="versionnumber" class="form-control">
              </div>


              <!--detailtype-->

              <div *ngIf="hidelist.indexOf('detailtype') == -1" class="col"><label for="detailtype"
                  class="control-label">Detail Type</label>
                <select *ngIf="!showview" id="detailtype" (change)="detailtypeonChange($event.target)"
                  formControlName="detailtype" class="form-control">
                  <option value="0">-Select-</option>
                  <option *ngFor="let item of detailtypeList" value="{{item.configkey}}">{{item.configtext}}</option>
                </select>
                <label *ngIf="showview" class="labelview">{{f.detailtype?.value}}</label>
              </div>
            </div>


            <!--itemid-->

            <div *ngIf="(viewhtml == '' || !showview)" class="form-group row">
              <div *ngIf="hidelist.indexOf('itemid') == -1" class="col"><label for="itemid" class="control-label"
                  (click)="AddOrEdititemid(null)">Item</label>
                <app-popupselect *ngIf="!showview" [options]="itemidList" [optionsEvent]="itemidoptionsEvent"
                  [form]="erpitemmaster" (selectItem)="onSelecteditemid($event)" [reportid]='cmpvs' [menuid]='cmpvs'
                  formControlName="itemid" id="itemid" desc="itemcode"></app-popupselect>
                <div class="input-group">
                </div>
                <label *ngIf="showview" class="labelview">{{f.itemid?.value}}</label>
              </div>
              <div *ngIf="hidelist.indexOf('description') == -1" class="col ">
                <label for="description" class="control-label">Description</label>
                <label *ngIf="showview" class="labelview">{{f.description?.value}}</label>
                <input *ngIf="!showview" id="description" formControlName="description" class="form-control">
              </div>
              <div *ngIf="hidelist.indexOf('details') == -1" class="col ">
                <label for="details" class="control-label">Details</label>
                <label *ngIf="showview" class="labelview">{{f.details?.value}}</label>
                <input *ngIf="!showview" id="details" formControlName="details" class="form-control">
              </div>
              <div *ngIf="hidelist.indexOf('quantity') == -1" class="col ">
                <label for="quantity" class="control-label">Quantity</label>
                <label *ngIf="showview" class="labelview">{{f.quantity?.value}}</label>
                <input *ngIf="!showview" id="quantity" formControlName="quantity" class="form-control">
                <app-field-error-display
                  [displayError]="f.quantity.errors!=null && f.quantity.errors.pattern!=null && f.quantity.errors!=undefined && f.quantity.errors.pattern!=undefined  && (f.quantity.touched|| isSubmitted)"
                  errorMsg="Not a valid number">
                </app-field-error-display>
                <app-field-error-display
                  [displayError]="f.quantity.errors!=null && f.quantity.errors.min!=null && f.quantity.errors!=undefined && f.quantity.errors.min!=undefined  && (f.quantity.touched|| isSubmitted)"
                  errorMsg="Minimum value have to be entered">
                </app-field-error-display>
                <app-field-error-display
                  [displayError]="f.quantity.errors!=null && f.quantity.errors.max!=null && f.quantity.errors!=undefined && f.quantity.errors.max!=undefined  && (f.quantity.touched|| isSubmitted)"
                  errorMsg="Maximum value Exceeded">
                </app-field-error-display>
              </div>
            </div>


            <!--uom-->

            <div *ngIf="(viewhtml == '' || !showview)" class="form-group row">
              <div *ngIf="hidelist.indexOf('uom') == -1" class="col"><label for="uom" class="control-label">U O
                  M</label>
                <select *ngIf="!showview" id="uom" (change)="uomonChange($event.target)" formControlName="uom"
                  class="form-control">
                  <option value="0">-Select-</option>
                  <option *ngFor="let item of uomList" value="{{item.configkey}}">{{item.configtext}}</option>
                </select>
                <label *ngIf="showview" class="labelview">{{f.uom?.value}}</label>
              </div>


              <!--currency-->

              <div *ngIf="hidelist.indexOf('currency') == -1" class="col"><label for="currency"
                  class="control-label">Currency</label>
                <select *ngIf="!showview" id="currency" (change)="currencyonChange($event.target)"
                  formControlName="currency" class="form-control">
                  <option value="0">-Select-</option>
                  <option *ngFor="let item of currencyList" value="{{item.configkey}}">{{item.configtext}}</option>
                </select>
                <label *ngIf="showview" class="labelview">{{f.currency?.value}}</label>
              </div>
              <div *ngIf="hidelist.indexOf('unitprice') == -1" class="col ">
                <label for="unitprice" class="control-label">Unit Price</label>
                <label *ngIf="showview" class="labelview">{{f.unitprice?.value}}</label>
                <input *ngIf="!showview" id="unitprice" formControlName="unitprice" currencyMask
                  [options]="{ prefix: '',precision: 0, thousands: ',', decimal: '.' }" class="form-control">
              </div>
              <div *ngIf="hidelist.indexOf('discountpercent') == -1" class="col ">
                <label for="discountpercent" class="control-label">Discountpercent</label>
                <label *ngIf="showview" class="labelview">{{f.discountpercent?.value}}</label>
                <input *ngIf="!showview" id="discountpercent" formControlName="discountpercent" class="form-control">
              </div>
            </div>


            <!--discounttype-->

            <div *ngIf="(viewhtml == '' || !showview)" class="form-group row">
              <div *ngIf="hidelist.indexOf('discounttype') == -1" class="col"><label for="discounttype"
                  class="control-label">Discount Type</label>
                <select *ngIf="!showview" id="discounttype" (change)="discounttypeonChange($event.target)"
                  formControlName="discounttype" class="form-control">
                  <option value="0">-Select-</option>
                  <option *ngFor="let item of discounttypeList" value="{{item.configkey}}">{{item.configtext}}</option>
                </select>
                <label *ngIf="showview" class="labelview">{{f.discounttype?.value}}</label>
              </div>
              <div *ngIf="hidelist.indexOf('saleprice') == -1" class="col ">
                <label for="saleprice" class="control-label">Sale Price</label>
                <label *ngIf="showview" class="labelview">{{f.saleprice?.value}}</label>
                <input *ngIf="!showview" id="saleprice" formControlName="saleprice" class="form-control">
              </div>


              <!--tax1name-->

              <div *ngIf="hidelist.indexOf('tax1name') == -1" class="col"><label for="tax1name" class="control-label"
                  (click)="AddOrEdittax1name(null)">Tax1 Name</label>
                <select *ngIf="!showview" id="tax1name" (change)="tax1nameonChange($event.target)"
                  formControlName="tax1name" class="form-control">
                  <option value="0">-Select-</option>
                  <option *ngFor="let item of tax1nameList" value="{{item.taxid}}">{{item.taxname}}</option>
                </select>
                <label *ngIf="showview" class="labelview">{{f.tax1name?.value}}</label>
              </div>
              <div *ngIf="hidelist.indexOf('tax1value') == -1" class="col ">
                <label for="tax1value" class="control-label">Tax1 Value</label>
                <label *ngIf="showview" class="labelview">{{f.tax1value?.value}}</label>
                <input *ngIf="!showview" id="tax1value" formControlName="tax1value" class="form-control">
                <app-field-error-display
                  [displayError]="f.tax1value.errors!=null && f.tax1value.errors.pattern!=null && f.tax1value.errors!=undefined && f.tax1value.errors.pattern!=undefined  && (f.tax1value.touched|| isSubmitted)"
                  errorMsg="Not a valid number">
                </app-field-error-display>
                <app-field-error-display
                  [displayError]="f.tax1value.errors!=null && f.tax1value.errors.min!=null && f.tax1value.errors!=undefined && f.tax1value.errors.min!=undefined  && (f.tax1value.touched|| isSubmitted)"
                  errorMsg="Minimum value have to be entered">
                </app-field-error-display>
                <app-field-error-display
                  [displayError]="f.tax1value.errors!=null && f.tax1value.errors.max!=null && f.tax1value.errors!=undefined && f.tax1value.errors.max!=undefined  && (f.tax1value.touched|| isSubmitted)"
                  errorMsg="Maximum value Exceeded">
                </app-field-error-display>
              </div>
            </div>
            <div *ngIf="(viewhtml == '' || !showview)" class="form-group row">
              <div *ngIf="hidelist.indexOf('tax2name') == -1" class="col ">
                <label for="tax2name" class="control-label">Tax2 Name</label>
                <label *ngIf="showview" class="labelview">{{f.tax2name?.value}}</label>
                <input *ngIf="!showview" id="tax2name" formControlName="tax2name" class="form-control">
              </div>
              <div *ngIf="hidelist.indexOf('tax2value') == -1" class="col ">
                <label for="tax2value" class="control-label">Tax2 Value</label>
                <label *ngIf="showview" class="labelview">{{f.tax2value?.value}}</label>
                <input *ngIf="!showview" id="tax2value" formControlName="tax2value" class="form-control">
              </div>
              <div *ngIf="hidelist.indexOf('othercharges') == -1" class="col ">
                <label for="othercharges" class="control-label">Other Charges</label>
                <label *ngIf="showview" class="labelview">{{f.othercharges?.value}}</label>
                <input *ngIf="!showview" id="othercharges" formControlName="othercharges" currencyMask
                  [options]="{ prefix: '',precision: 0, thousands: ',', decimal: '.' }" class="form-control">
              </div>
              <div *ngIf="hidelist.indexOf('totalquotevalue') == -1" class="col ">
                <label for="totalquotevalue" class="control-label">Total Quote Value</label>
                <label *ngIf="showview" class="labelview">{{f.totalquotevalue?.value}}</label>
                <input *ngIf="!showview" id="totalquotevalue" formControlName="totalquotevalue" currencyMask
                  [options]="{ prefix: '',precision: 0, thousands: ',', decimal: '.' }" class="form-control">
              </div>
            </div>


            <!--basecurrency-->

            <div *ngIf="(viewhtml == '' || !showview)" class="form-group row">
              <div *ngIf="hidelist.indexOf('basecurrency') == -1" class="col"><label for="basecurrency"
                  class="control-label">Base Currency</label>
                <select *ngIf="!showview" id="basecurrency" formControlName="basecurrency" class="form-control">
                  <option value="0">-Select-</option>
                  <option *ngFor="let item of currencyToSymbolMap1" value="{{item[0]}}">{{item[0]}} {{item[1]}}</option>
                </select>
                <label *ngIf="showview" class="labelview">{{f.basecurrency?.value}}</label>
              </div>
              <div *ngIf="hidelist.indexOf('basevalue') == -1" class="col ">
                <label for="basevalue" class="control-label">Base Value</label>
                <label *ngIf="showview" class="labelview">{{f.basevalue?.value}}</label>
                <input *ngIf="!showview" id="basevalue" formControlName="basevalue" currencyMask
                  [options]="{ prefix: '',precision: 0, thousands: ',', decimal: '.' }" class="form-control">
              </div>
              <div *ngIf="hidelist.indexOf('expecteddelivery') == -1" class="col ">
                <label for="expecteddelivery" class="control-label">Expected Delivery</label>
                <label *ngIf="showview"
                  class="labelview">{{ngbDateParserFormatter.format(f.expecteddelivery?.value)}}</label>
                <div class="input-group" *ngIf="!showview">
                  <input #expecteddeliveryformpicker="ngbDatepicker" ngbDatepicker name="expecteddeliveryformpicker"
                    id="expecteddelivery" formControlName="expecteddelivery" class="form-control">
                  <button class="input-group-addon" *ngIf="!showview" (click)="expecteddeliveryformpicker.toggle()"
                    type="button"><i class="fa fa-calendar" aria-hidden="true"></i></button>
                </div>
              </div>
              <div *ngIf="hidelist.indexOf('size') == -1" class="col ">
                <label for="size" class="control-label">Size</label>
                <label *ngIf="showview" class="labelview">{{f.size?.value}}</label>
                <input *ngIf="!showview" id="size" formControlName="size" class="form-control">
              </div>
            </div>
            <div *ngIf="(viewhtml == '' || !showview)" class="form-group row">
              <div *ngIf="hidelist.indexOf('color') == -1" class="col ">
                <label for="color" class="control-label">Color</label>
                <label *ngIf="showview" class="labelview">{{f.color?.value}}</label>
                <input *ngIf="!showview" id="color" formControlName="color" class="form-control">
              </div>
              <div *ngIf="hidelist.indexOf('weight') == -1" class="col ">
                <label for="weight" class="control-label">Weight</label>
                <label *ngIf="showview" class="labelview">{{f.weight?.value}}</label>
                <input *ngIf="!showview" id="weight" formControlName="weight" class="form-control">
              </div>
              <div *ngIf="hidelist.indexOf('notes') == -1" class="col ">
                <label for="notes" class="control-label">Notes</label>
                <label *ngIf="showview" class="labelview">{{f.notes?.value}}</label>
                <input *ngIf="!showview" id="notes" formControlName="notes" class="form-control">
              </div>
              <div *ngIf="hidelist.indexOf('paymenttermtype') == -1" class="col ">
                <div class="columnchk">
                  <label for="paymenttermtype" class="control-label">Payment Term Type</label>
                  <label *ngIf="showview" class="labelview">{{f.paymenttermtype?.value}}</label>
                  <input type="checkbox" *ngIf="!showview" id="paymenttermtype" formControlName="paymenttermtype"
                    class="form-control">
                </div>
              </div>
            </div>
            <div *ngIf="(viewhtml == '' || !showview)" class="form-group row">
              <div *ngIf="hidelist.indexOf('remarks') == -1" class="col ">
                <label for="remarks" class="control-label">Remarks</label>
                <label *ngIf="showview" class="labelview">{{f.remarks?.value}}</label>
                <textarea autosize MinRows="10" MaxRows="15" onlyGrow="true" *ngIf="!showview" id="remarks"
                  formControlName="remarks" class="form-control">
</textarea>
              </div>
            </div>
          </p-accordion>
        </ng-template>
      </ngb-tab>
      <ngb-tab>
        <ng-template ngbTabTitle>
          <div (click)="ToolBar(false)">purchasesubdeliverydetails</div>
        </ng-template>
        <ng-template ngbTabContent>
          <p-accordion [multiple]='true'>
            <!-- child table erppurchasesubdeliverydetails-->
            <div [ngClass]="IserppurchasesubdeliverydetailsVisible()">
              <!--End-->
              <h4 class="form-group sticky1  columns left">{{'purchasesubdeliverydetails' | translate}}
                <select class='child' id="erppurchasesubdeliverydetailsPagingdropdown"
                  (change)="erppurchasesubdeliverydetailsPaging($event.target.value)" [value]='20'>
                  <option value='20'>20</option>
                  <option value='50'>50</option>
                  <option value='100'>100</option>
                </select>
                <div class="right" role="toolbar" aria-label="Toolbar with button groups">
                  <!--btn-toolbar-->
                  <div class="btn-group mr-2" role="group" aria-label="First group">
                    <a class='nav-link dropdown-toggle btn-success' (click)='erppurchasesubdeliverydetailtoggleOption()'
                      data-toggle='dropdown' [routerLink]='' role='button' aria-haspopup='true'
                      aria-expanded='false'></a>
                    <div class='dropdown-menu' style='display:block'
                      *ngIf='this.erppurchasesubdeliverydetailshowOption'>
                      <a class="dropdown-item" [routerLink]=''
                        (click)="erppurchasesubdeliverydetailtoggleOption();erppurchasesubdeliverydetailsroute(null, 'create')"><i
                          class="fa fa-plus" aria-hidden="true"></i>&nbsp;&nbsp;&nbsp;New</a>
                      <div class='dropdown-divider'></div>
                      <a class="dropdown-item" [routerLink]=''
                        (click)="erppurchasesubdeliverydetailtoggleOption();showerppurchasesubdeliverydetailsFilter()"><i
                          class="fa fa-filter" aria-hidden="true"></i>&nbsp;&nbsp;&nbsp;Filter</a>
                      <a class="dropdown-item" [routerLink]=''><i class="fa fa-envelope"
                          aria-hidden="true"></i>&nbsp;&nbsp;&nbsp;Mail</a>
                    </div>
                  </div>
                </div>
              </h4>
              <ng2-smart-table #tblerppurchasesubdeliverydetailssource
                (userRowSelect)="handleerppurchasesubdeliverydetailsGridSelected($event)"
                [settings]="erppurchasesubdeliverydetailssettings"
                (custom)="onCustomerppurchasesubdeliverydetailsAction($event)"
                [source]="erppurchasesubdeliverydetailssource"
                (delete)="erppurchasesubdeliverydetailsroute($event,'delete')"
                (deleteConfirm)="erppurchasesubdeliverydetailsroute($event,'delete')"
                (create)="erppurchasesubdeliverydetailsroute($event,'create')"
                (createConfirm)="erppurchasesubdeliverydetailsbeforesave($event)"
                (edit)="erppurchasesubdeliverydetailsroute($event,'edit')"
                (editConfirm)="erppurchasesubdeliverydetailsbeforesave($event)">
              </ng2-smart-table>
            </div>
            <!--End of child table erppurchasesubdeliverydetails-->
          </p-accordion>
        </ng-template>
      </ngb-tab>
    </ngb-tabset>
  </div>
</form>